{% load static %}
<aside class="fixed top-0 left-0 h-screen w-64 glass-sidebar z-50 overflow-y-auto">
    <!-- Logo -->
    <div class="flex items-center justify-center h-20 border-b border-white/10">
        <img src="{% static 'images/logo.png' %}" alt="Logo" class="h-12 w-12 rounded-full border-2 border-white/30">
        <span class="ml-3 text-xl font-bold text-white">KSS</span>
    </div>
    
    <!-- Navigation -->
    <nav class="mt-6 pb-6">  <!-- Changed pb-24 to pb-6 since we removed user info section -->
        <ul class="space-y-1 px-3">
            <!-- Dashboard - Accessible to all authenticated users -->
            <li>
                <a href="{% url 'dashboard:home' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group {% if request.resolver_match.view_name == 'dashboard:home' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-tachometer-alt w-6 group-hover:text-white {% if request.resolver_match.view_name == 'dashboard:home' %}text-white{% endif %}"></i>
                    <span class="ml-2">Dashboard</span>
                </a>
            </li>
            
            <!-- Students Section - Admin & Teachers only -->
            {% if user.role == 'admin' or user.role == 'teacher' %}
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Student Management</span>
            </li>
            <li>
                <a href="{% url 'students:list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group {% if 'students' in request.path and 'students/dashboard' not in request.path %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-users w-6 group-hover:text-white"></i>
                    <span class="ml-2">All Students</span>
                </a>
            </li>
            {% if user.role == 'admin' %}
            <li>
                <a href="{% url 'students:create' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-user-plus w-6 group-hover:text-white"></i>
                    <span class="ml-2">Add Student</span>
                </a>
            </li>
            {% endif %}
            {% endif %}
            
            <!-- Student Portal Section -->
            {% if user.role == 'student' %}
                {% if user.student_profile %}
                <li class="mt-4 mb-1 px-4">
                    <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">My Portal</span>
                </li>
                <li>
                    <a href="{% url 'students:dashboard' %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group {% if 'students/dashboard' in request.path %}bg-white/20 text-white{% endif %}">
                        <i class="fas fa-user-graduate w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Profile</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'academics:student_results' user.student_profile.id %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-chart-line w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Results</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'finance:student_invoices' user.student_profile.id %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-wallet w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Fees</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'attendance:student_attendance' user.student_profile.id %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-clock w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Attendance</span>
                    </a>
                </li>
                {% endif %}
            {% endif %}
            
            <!-- Teachers Section - Admin only -->
            {% if user.role == 'admin' %}
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Staff Management</span>
            </li>
            <li>
                <a href="{% url 'teachers:list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group {% if 'teachers' in request.path and 'teachers/dashboard' not in request.path %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-chalkboard-teacher w-6 group-hover:text-white"></i>
                    <span class="ml-2">All Teachers</span>
                </a>
            </li>
            <li>
                <a href="{% url 'teachers:create' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-user-plus w-6 group-hover:text-white"></i>
                    <span class="ml-2">Add Teacher</span>
                </a>
            </li>
            {% endif %}
            
            <!-- Teacher Portal Section -->
            {% if user.role == 'teacher' %}
                {% if user.teacher_profile %}
                <li class="mt-4 mb-1 px-4">
                    <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">My Classes</span>
                </li>
                <li>
                    <a href="{% url 'teachers:dashboard' %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group {% if 'teachers/dashboard' in request.path %}bg-white/20 text-white{% endif %}">
                        <i class="fas fa-chalkboard w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'teachers:classes' user.teacher_profile.id %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-school w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Classes</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'teachers:subjects' user.teacher_profile.id %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-book-open w-6 group-hover:text-white"></i>
                        <span class="ml-2">My Subjects</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'attendance:mark_attendance' %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-calendar-check w-6 group-hover:text-white"></i>
                        <span class="ml-2">Mark Attendance</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'academics:exam_list' %}" 
                       class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                        <i class="fas fa-pen w-6 group-hover:text-white"></i>
                        <span class="ml-2">Enter Marks</span>
                    </a>
                </li>
                {% endif %}
            {% endif %}
            
            <!-- Academics Section - All authenticated users except students (who have their own portal) -->
            {% if user.is_authenticated and user.role != 'student' %}
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Academics</span>
            </li>
            <li>
                <a href="{% url 'academics:subject_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-book-open w-6 group-hover:text-white"></i>
                    <span class="ml-2">Subjects</span>
                </a>
            </li>
            <li>
                <a href="{% url 'academics:class_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-school w-6 group-hover:text-white"></i>
                    <span class="ml-2">Classes</span>
                </a>
            </li>
            <li>
                <a href="{% url 'academics:exam_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-file-alt w-6 group-hover:text-white"></i>
                    <span class="ml-2">Exams</span>
                </a>
            </li>
            <li>
                <a href="{% url 'academics:homework_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-home w-6 group-hover:text-white"></i>
                    <span class="ml-2">Homework</span>
                </a>
            </li>
            {% endif %}
            
            <!-- Finance Section - Admin & Accountant only -->
            {% if user.role == 'admin' or user.role == 'accountant' %}
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Finance</span>
            </li>
            <li>
                <a href="{% url 'finance:dashboard' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-chart-pie w-6 group-hover:text-white"></i>
                    <span class="ml-2">Dashboard</span>
                </a>
            </li>
            <li>
                <a href="{% url 'finance:fee_structure_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-tags w-6 group-hover:text-white"></i>
                    <span class="ml-2">Fee Structures</span>
                </a>
            </li>
            <li>
                <a href="{% url 'finance:invoice_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-file-invoice w-6 group-hover:text-white"></i>
                    <span class="ml-2">Invoices</span>
                </a>
            </li>
            <li>
                <a href="{% url 'finance:payment_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-money-bill-wave w-6 group-hover:text-white"></i>
                    <span class="ml-2">Payments</span>
                </a>
            </li>
            <li>
                <a href="{% url 'finance:expense_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-receipt w-6 group-hover:text-white"></i>
                    <span class="ml-2">Expenses</span>
                </a>
            </li>
            <li>
                <a href="{% url 'finance:budget_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-chart-line w-6 group-hover:text-white"></i>
                    <span class="ml-2">Budgets</span>
                </a>
            </li>
            {% endif %}
            
            <!-- Attendance Section - Admin & Teacher only -->
            {% if user.role == 'admin' or user.role == 'teacher' %}
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Attendance</span>
            </li>
            <li>
                <a href="{% url 'attendance:attendance_dashboard' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-clock w-6 group-hover:text-white"></i>
                    <span class="ml-2">Dashboard</span>
                </a>
            </li>
            <li>
                <a href="{% url 'attendance:mark_attendance' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-pen-alt w-6 group-hover:text-white"></i>
                    <span class="ml-2">Mark Attendance</span>
                </a>
            </li>
            <li>
                <a href="{% url 'attendance:attendance_reports' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-chart-bar w-6 group-hover:text-white"></i>
                    <span class="ml-2">Reports</span>
                </a>
            </li>
            <li>
                <a href="{% url 'attendance:holiday_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-umbrella-beach w-6 group-hover:text-white"></i>
                    <span class="ml-2">Holidays</span>
                </a>
            </li>
            {% endif %}
            
            <!-- Communication Section - All authenticated users -->
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Communication</span>
            </li>
            <li>
                <a href="{% url 'messaging:inbox' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group {% if 'messaging' in request.path %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-envelope w-6 group-hover:text-white"></i>
                    <span class="ml-2">Messages</span>
                    {% if unread_notifications_count %}
                    <span class="ml-auto bg-red-500 text-white text-xs rounded-full px-2 py-1">{{ unread_notifications_count }}</span>
                    {% endif %}
                </a>
            </li>
            <li>
                <a href="{% url 'messaging:announcement_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-bullhorn w-6 group-hover:text-white"></i>
                    <span class="ml-2">Announcements</span>
                </a>
            </li>
            <li>
                <a href="{% url 'messaging:compose' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-paper-plane w-6 group-hover:text-white"></i>
                    <span class="ml-2">Compose</span>
                </a>
            </li>
            
            <!-- Reports Section - All authenticated users -->
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Reports</span>
            </li>
            <li>
                <a href="{% url 'reports:index' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-file-pdf w-6 group-hover:text-white"></i>
                    <span class="ml-2">All Reports</span>
                </a>
            </li>
            <li>
                <a href="{% url 'reports:custom_report' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-sliders-h w-6 group-hover:text-white"></i>
                    <span class="ml-2">Custom Report</span>
                </a>
            </li>
            
            <!-- Admin Section - Admin only -->
            {% if user.role == 'admin' %}
            <li class="mt-4 mb-1 px-4">
                <span class="text-xs font-semibold text-white/40 uppercase tracking-wider">Administration</span>
            </li>
            <li>
                <a href="{% url 'accounts:user_list' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-user-cog w-6 group-hover:text-white"></i>
                    <span class="ml-2">User Management</span>
                </a>
            </li>
            <li>
                <a href="{% url 'accounts:audit_logs' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-history w-6 group-hover:text-white"></i>
                    <span class="ml-2">Audit Logs</span>
                </a>
            </li>
            <li>
                <a href="{% url 'admin:index' %}" 
                   class="flex items-center px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all group">
                    <i class="fas fa-cogs w-6 group-hover:text-white"></i>
                    <span class="ml-2">Admin Panel</span>
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>
    
    <!-- REMOVED: Duplicate user profile section - now only appears in navbar -->
</aside>

<style>
.glass-sidebar {
    background: rgba(17, 25, 40, 0.85);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-right: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

/* Custom scrollbar for sidebar */
.glass-sidebar::-webkit-scrollbar {
    width: 4px;
}

.glass-sidebar::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

.glass-sidebar::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
}

.glass-sidebar::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Active link indicator */
.bg-white\/20 {
    background: rgba(59, 130, 246, 0.3);
    border-left: 3px solid #3b82f6;
}

/* Hover effects */
.hover\:bg-white\/10:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* Section headers */
.text-white\/40 {
    color: rgba(255, 255, 255, 0.4);
    font-weight: 600;
    letter-spacing: 0.05em;
}
</style>